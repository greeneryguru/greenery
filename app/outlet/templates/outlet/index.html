{% extends "base.html" %}
{% block headers %}
    <script>
    $(document).ready(function() {
        $("input:checkbox").change(function(){
            var pk = this.id.split("-")[1];
            var self = this;
            $.post("/outlet/" + pk + "/toggle", 
                {}, function(data){
                    $(self).prop("checked", data.state);
			}, 'json');
			return false;
        });
        $("button").click(function(){
            var [mode, pk] = this.id.split('-',2);
            if (mode == 'edit') {
                location.href = "/outlet/" + pk + "/edit";
            } else {
                if (window.confirm("Are you sure you want to delete this object from the system?")) {
                    $.post("/outlet/" + pk + "/delete",
                        {'csrfmiddlewaretoken': '{{ csrf_token() }}'}, 
                        function(){location.reload();}
                    );
                }
            }
			return false;
        });
    });
    </script>
{% endblock %}

{% block content %}
{% if payload %}
    <table>
    <thead></thead>
    {% for o in payload %}
    <tr>
        <td class="nolines">
            <a class="button" href="/outlet/{{ o.id }}/edit" style="min-width: 180px; width: 100%;">{{ o.name }}</a>
        </td>
        <td class="nolines">
            <label class="switch">
            <input type="checkbox" id="outlet-{{ o.id }}"{% if o.state == 1 %} checked
            {% endif %}>
            <span class="slider round"></span>
            </label>
        </td>
    {% endfor %}
    </table>
{% else %}
    No data available
    <hr>
{% endif %}
<a href="/outlet/create">add new <i class="fa fa-plus"></i></a>
{% endblock %}
