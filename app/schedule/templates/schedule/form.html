{% extends "base.html" %}
{% block headers %}
    <script>
    $(document).ready(function() {
        $("#days").css("display", "none");
        $("input:checkbox").each(function(){
  		    var self = this;
            var a = parseInt($("#days").val());
            var b = parseInt($(self).val());
    	    if (a & b) {
      	        $(self).prop("checked", true);
    	    } else {
      	        $(self).prop("checked", false);
            }
        });    
        $("input:checkbox").change(function(){
            var self = this;
            var a = parseInt($("#days").val());
            var b = parseInt($(self).val());
            if ($(self).prop("checked")) {
                $("#days").val(a + b);
            } else {
                $("#days").val(a - b);
            }
        });
        $("button.greenery").click(function(){
            var [mode, pk] = this.id.split('-',2);
            if (mode == "delete") {
                if (window.confirm("Are you sure you want to delete this object from the system?")) {          
                    $.post("/schedule/" + pk + "/delete",
                        {'csrfmiddlewaretoken': '{{ csrf_token() }}'},
                        function(){
                            window.location.replace("/schedule");
                        }
                    );
                }
            }
			return false;
        });
    });
    </script>
{% endblock headers %}
{% block content %}
{% if title %}
    <h3>{{ title }}</h3>
{% endif %}
    <form action="" method="post" name="schedule">
        {{ form.hidden_tag() }}   
        <p>
        {{ form.outlet_id.label }} {{ form.outlet_id }}<br>
        {% for err in form.on_time.errors %}
            <span style="color: red;">[{{ err }}]</span>
        {% endfor %}<br>
        </p>
        <p>
        {{ form.on_time.label }} {{ form.on_time }}<br>
        {% for err in form.on_time.errors %}
            <span style="color: red;">[{{ err }}]</span>
        {% endfor %}<br>
        </p>
        <p>
        {{ form.off_time.label }} {{ form.off_time }}<br>
        {% for err in form.off_time.errors %}
            <span style="color: red;">[{{ err }}]</span>
        {% endfor %}<br>
        </p>
        <p>
        {% for d in dow %}
        <label class="form-label">{{ d.0 }}
        <input class="form-input" type="checkbox" id="cb-{{ d.0 }}" value="{{ d.1 }}">
        </label>
        {% endfor %}
        </p>
        <p>
        <input type="submit" value="{% if pk %}Save{% else %}Submit{% endif %}">
        {% if pk %}<button class="button greenery" type="button" id="delete-{{ pk }}">Delete</button>{% endif %}        
        </p>
    </form>
{% endblock content %}



