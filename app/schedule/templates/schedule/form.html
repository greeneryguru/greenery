{% extends "base.html" %}
{% block headers %}
    <script>
    $(document).ready(function() {
        $("#days").css("display", "none");
        $("input:checkbox").each(function(){
  		    var self = this;
            var a = parseInt($("#days").val());
            var b = parseInt($(self).val());
    	    if (a & b) {
      	        $(self).prop("checked", true);
    	    } else {
      	        $(self).prop("checked", false);
            }
        });    
        $("input:checkbox").change(function(){
            var self = this;
            var a = parseInt($("#days").val());
            var b = parseInt($(self).val());
            if ($(self).prop("checked")) {
                $("#days").val(a + b);
            } else {
                $("#days").val(a - b);
            }
        });
        $(".pure-button.delete").click(function(){
            var [mode, pk] = this.id.split('-',2);
            if (mode == "delete") {
                if (window.confirm("Are you sure you want to delete this object from the system?")) {          
                    $.post("/schedule/" + pk + "/delete",
                        {'csrfmiddlewaretoken': '{{ csrf_token() }}'},
                        function(){
                            window.location.replace("/schedule");
                        }
                    );
                }
            }
			return false;
        });
    });
    </script>
{% endblock headers %}
{% block content %}
    <form action="" method="post" name="schedule"  class="pure-form pure-form-aligned">
        {{ form.hidden_tag() }}
        <fieldset>
        <div class="pure-control-group">
            {{ form.outlet_id.label }}
            {{ form.outlet_id }}
            {% for err in form.outlet_id.errors %}
            <span class="pure-form-message-inline">[{{ err }}]</span>
            {% endfor %}
        </div>
        <div class="pure-control-group">
            {{ form.on_time.label }}
            {{ form.on_time }}
            {% for err in form.on_time.errors %}
            <span class="pure-form-message-inline">[{{ err }}]</span>
            {% endfor %}
        </div>
        <div class="pure-control-group">
            {{ form.off_time.label }}
            {{ form.off_time }}
            {% for err in form.off_time.errors %}
            <span class="pure-form-message-inline">[{{ err }}]</span>
            {% endfor %}
        </div>
        <div class="pure-control-group">
            <label>Days</label>
            {% for d in dow %}
                <div class="clump" style="display: inline;">
                <input style="display: inline;" type="checkbox" id="cb-{{ d.0 }}" value="{{ d.1 }}">
                <label style="display: inline; padding-right: 0;" for="cb-{{ d.0 }}">{{ d.0 }}</label>
                </div>
            {% endfor %}
        
        <div class="pure-controls">
            <button type="submit" class="pure-button pure-button-primary">Submit</button>
            {% if pk %}<button type="button" class="pure-button delete" id="delete-{{ pk }}">Delete</button>{% endif %}
        </div>
        </fieldset>
    </form>
{% endblock content %}



